<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>概要</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
MutterAPI は、プッシュ配信型データ通信を実現するつぶやき通信パッケージです。<br/>

<h3>概要</h3>
<p>
つぶやき通信では受信する側が送信元をフォローするという形で接続を行います。<br/>
送信元や受信先が実際には居なくともエラーにはならないように設計しています。<br/>
<br/>
送信元が居なければ単にメッセージが送られないだけです。<br/>
受信先が居なければメッセージキューのような蓄積は行わずに、メッセージを即時廃棄します。<br/>
<br/>
主な用途としては、動的に組み込まれるプラグイン間の連携などを想定しています。<br/>
</p>

<h3>基本機能</h3>
<p>
つぶやき通信は、同じ「部屋(util.mutter.Room)」を通信範囲とします。<br/>
部屋は複数設置可能でそれぞれ識別名によるシングルトンで、Room.getRoom(部屋名) と呼ぶことで取得（もしくは新規作成）できます。<br/>
この「部屋」には「座席(util.mutter.Seat)」があり、シングルトンとして 「部屋」.getSeat(座席名) と取得できます。<br/>
<br/>
「部屋」と「座席」があれば、次は座る人「利用者(util.mutter.User)」が登場します。<br/>
APIを利用する場合は、継承により「利用者(util.mutter.User)」をカスタマイズします。<br/>
具体的には、実際に独り言などを聞いた場合の処理 (利用者.received(メッセージ)) が abstract なので実装する必要があります。<br/>
次にこの「利用者」は「座席」に座る (「座席」.sitDown(利用者)) ことが出来ます。<br/>
座席に座っている利用者は、当然に聞き耳を立てるだけではなく、独り言を言う([利用者].mutter(メッセージ))ことも出来ます。<br/>
また全ての座席からのつぶやきを聞いていたら処理能力がいくらあっても足りません。<br/>
「利用者」は別の座席に座っている利用者の独り言に聞き耳立てる(「利用者」.follow(座席名))必要があります。<br/>
聞き耳を立て（フォローす）れば、あとは自動的に相手のつぶやきは (利用者.received(メッセージ)) で利用者の耳に届くことになります。<br/>
<br/>
ここでの要点は、独り言を言うのも聞き耳立てるのも、必ずしも相手の「利用者」を必要としないことです。<br/>
あくまで「座席」に対しての行動なのです。<br/>
一人きりだとしても、ブツブツと独り言を言い続けたり、誰もいない「部屋」でジッと聞き耳を立て続けているだけです。<br/>
害はありません。通報したりしないでください。侘びしい光景ですが。<br/>
</p>

<h3>拡張機能</h3>
<p>
「部屋」の中で独り言を延々とつぶやくのも趣がありますが、別の「部屋」でのつぶやきを聞きたい事もあるかと思います。<br/>
そんな需要に答えるのが「廊下(util.mutter.PassageWay)」です。<br/>
「廊下」は「部屋」と「部屋」を結んで、つぶやきを届けます。<br/>
適切に「廊下」が用意してあるならば、「利用者」はあたかも同じ「部屋」にいるように独り言や聞き耳を行うだけです。<br/>
「廊下」は単純に実装したならば「座席」で生成された全てのメッセージ（フォローにより生成されるメッセージも含みます）を拾って別の「部屋」に流します。<br/>
パフォーマンスの軽減を考慮する場合には「廊下」で不要なメッセージはフィルタするなどしてください。<br/>
<br/>
「廊下」は公式の設備ですが、もっと非公式な設備もあります。<br/>
それが「盗聴器(util.mutter.Microphone)」です。<br/>
端的に言えば、「部屋」の中のあらゆるメッセージをピックアップしつづけます。<br/>
デバッグなどでの利用を想定しています。<br/>
</p>
</body>
</html>